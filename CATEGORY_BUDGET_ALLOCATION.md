# カテゴリ別予算配分機能

## ✨ 機能概要

チーム予算をカテゴリごとに分配し、より詳細な予算管理を可能にする機能です。各カテゴリに予算上限を設定し、リアルタイムで予算使用状況を監視できます。

## 🔧 主な機能

### 1. カテゴリ別予算設定
- 各カテゴリに個別の予算配分額を設定
- チーム予算を超えない範囲でのバリデーション
- 0円設定で予算制限なしも選択可能

### 2. リアルタイム予算監視
- カテゴリごとの使用済み・予定・残り予算の表示
- 予算使用率の視覚的プログレスバー
- 予算超過時の警告表示とハイライト

### 3. 予算配分概要
- チーム総予算・配分済み・未配分予算の一覧表示
- 予算超過アラート機能
- 配分状況の即座確認

### 4. 智能バリデーション
- 配分総額がチーム予算を超えない制御
- カテゴリ追加・編集時の自動チェック
- ユーザーフレンドリーなエラーメッセージ

## 💾 データベース拡張

### 新規カラム
```sql
ALTER TABLE `purpose_categories` ADD COLUMN `budget_allocation` int DEFAULT 0 AFTER `sort_order`;
```

### カラム概要
- `budget_allocation`: カテゴリに配分された予算額（円）
- 0の場合は予算制限なし
- デフォルト値は0

## 🎯 使用方法

### 予算設定
1. チーム画面から「🏷️ カテゴリ管理」をクリック
2. 「💰 予算配分概要」で配分状況を確認
3. カテゴリの「編集」で予算配分額を設定
4. システムが自動的にチーム予算内かチェック

### 予算監視
1. チーム画面の「📊 カテゴリ別集計」を確認
2. プログレスバーで使用率を視覚的に把握
3. 予算超過カテゴリは赤色でハイライト
4. リアルタイムで残り予算を確認

## 🔍 表示要素

### カテゴリ管理画面
- **予算配分概要**: チーム総予算・配分済み・未配分の表示
- **配分済み額**: 各カテゴリテーブルに予算配分額を表示
- **バリデーション**: 予算超過時のエラーメッセージ
- **残り予算**: 新規追加時に利用可能な残り予算を表示

### チーム画面
- **プログレスバー**: カテゴリごとの予算使用率を視覚化
- **予算詳細**: 配分・使用済み・予定・残り予算の詳細表示
- **超過警告**: 予算超過カテゴリの背景色変更
- **使用率**: パーセンテージでの予算使用率表示

## 🎨 視覚的特徴

### カラーコーディング
- **緑色**: 予算内での正常な使用状況
- **赤色**: 予算超過時の警告表示
- **青色**: 配分済み予算の表示
- **グレー**: 未配分・無制限予算の表示

### プログレスバー
- カテゴリカラーでの使用率表示
- 100%超過時は赤色に変化
- スムーズなアニメーション効果

## 🚀 導入効果

### 予算管理の精密化
- チーム予算の細分化による詳細管理
- カテゴリごとの支出傾向の把握
- 予算配分の最適化支援

### リスク管理
- 予算超過の事前察知
- リアルタイムアラート機能
- 予算制御による無駄遣い防止

### 意思決定支援
- データに基づく予算配分判断
- 過去実績の活用
- 次回イベントでの予算計画精度向上

## 🔄 既存機能との互換性

- 既存の領収書・予定用途データは影響なし
- カテゴリ未設定データも正常に表示
- 段階的な導入が可能（0円設定で従来通り使用可能）

この機能により、より詳細で効果的な予算管理が実現できます。